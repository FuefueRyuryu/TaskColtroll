<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>タスク管理 — シンプル版</title>
  <style>
    :root{
      --bg:#0f172a; --card:#0b1220; --accent:#7c3aed; --muted:#9aa4b2; --glass: rgba(255,255,255,0.04);
      --radius:14px; --glass-2: rgba(255,255,255,0.02);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Meiryo", sans-serif;
      background: linear-gradient(180deg,#071023 0%, #071633 60%); color:#e6eef6; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .app{
      width:100%; max-width:760px; background:linear-gradient(180deg,var(--card), rgba(10,16,28,0.95)); border-radius:18px; padding:22px; box-shadow: 0 10px 40px rgba(2,6,23,0.7);
      backdrop-filter: blur(6px);
    }
    header{display:flex; align-items:center; gap:12px;}
    header h1{margin:0; font-size:20px; letter-spacing:0.2px}
    .controls{display:flex; gap:8px; margin-top:14px}
    input[type=text]{flex:1; padding:12px 14px; border-radius:10px; border:1px solid var(--glass-2); background:transparent; color:inherit; outline:none; font-size:15px}
    button.btn{padding:10px 14px; border-radius:10px; border:0; cursor:pointer; font-weight:600}
    button.add{background:linear-gradient(90deg,var(--accent), #5b21b6); color:white}
    .meta{margin-top:8px; color:var(--muted); font-size:13px}

    .list{margin-top:18px; display:flex; flex-direction:column; gap:10px}
    .task{
      display:flex; align-items:center; gap:12px; padding:12px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.03);
      transform-origin:left center; transition:transform .18s ease, opacity .25s ease, height .25s ease, margin .25s ease;
    }
    .task .text{flex:1; word-break:break-word}
    .task .time{color:var(--muted); font-size:12px}
    .task .done{background:transparent; border:1px solid rgba(255,255,255,0.06); padding:8px 10px; border-radius:10px; cursor:pointer; font-weight:700}
    .task.removing{opacity:0; transform:translateX(30px) scale(.98); height:0; margin:0; padding:0}

    .empty{padding:24px; text-align:center; color:var(--muted); border-radius:12px; border:1px dashed rgba(255,255,255,0.03)}

    footer{margin-top:18px; display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:13px}
    .count{font-weight:700}

    @media (max-width:520px){
      .app{padding:16px}
      header h1{font-size:16px}
    }
  </style>
</head>
<body>
  <main class="app" role="main">
    <header>
      <svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
        <rect x="1" y="3" width="22" height="18" rx="4" stroke="white" stroke-opacity="0.08" stroke-width="1.2"/>
        <path d="M7 9h10M7 13h6" stroke="white" stroke-opacity="0.9" stroke-width="1.2" stroke-linecap="round"/>
      </svg>
      <div>
        <h1>シンプルタスク管理</h1>
        <div class="meta">予定の追加と、達成ボタンで消去できます</div>
      </div>
    </header>

    <div class="controls">
      <input id="taskInput" type="text" placeholder="予定を入力してください（例：会議 14:00）" aria-label="予定を入力" />
      <button id="addBtn" class="btn add">追加</button>
    </div>

    <div id="list" class="list" aria-live="polite">
      <!-- タスクがここに入る -->
    </div>

    <div id="empty" class="empty" style="display:none; margin-top:12px">予定はまだありません。追加してみましょう！</div>

    <footer>
      <div>残り: <span id="count" class="count">0</span></div>
      <div>
        <button id="clearAll" class="btn" style="background:transparent; border:1px solid rgba(255,255,255,0.04); padding:8px 10px; border-radius:10px">すべて削除</button>
      </div>
    </footer>
  </main>

  <script>
    // シンプルなタスク管理 — ローカルストレージで永続化
    (function(){
      const input = document.getElementById('taskInput');
      const addBtn = document.getElementById('addBtn');
      const list = document.getElementById('list');
      const empty = document.getElementById('empty');
      const countEl = document.getElementById('count');
      const clearAll = document.getElementById('clearAll');

      const STORAGE_KEY = 'simple_tasks_v1';

      // state
      let tasks = load();

      function save(){
        try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks)); }catch(e){console.warn('保存失敗', e)}
      }
      function load(){
        try{
          const raw = localStorage.getItem(STORAGE_KEY);
          if(!raw) return [];
          return JSON.parse(raw).map(t=>({...t}));
        }catch(e){return []}
      }

      function render(){
        list.innerHTML = '';
        if(tasks.length === 0){ empty.style.display = 'block'; } else { empty.style.display = 'none'; }
        tasks.forEach((t, idx)=>{
          const el = document.createElement('div');
          el.className = 'task';
          el.setAttribute('data-id', t.id);

          const text = document.createElement('div'); text.className='text';
          text.innerText = t.text;

          const time = document.createElement('div'); time.className='time';
          time.innerText = t.createdAt;

          const done = document.createElement('button'); done.className='done'; done.innerText='達成！';
          done.addEventListener('click', ()=> removeTask(t.id, el));

          el.appendChild(text);
          const right = document.createElement('div'); right.style.display='flex'; right.style.alignItems='center'; right.style.gap='10px';
          right.appendChild(time); right.appendChild(done);
          el.appendChild(right);

          list.appendChild(el);
        });
        countEl.innerText = tasks.length;
      }

      function addTask(text){
        if(!text || !text.trim()) return;
        const t = {
          id: 't_' + Date.now() + '_' + Math.floor(Math.random()*9999),
          text: text.trim(),
          createdAt: new Date().toLocaleString()
        };
        tasks.unshift(t);
        save();
        render();
        input.value='';
        input.focus();
      }

      function removeTask(id, el){
        // アニメーション: フェードアウトしてから配列から削除
        el.classList.add('removing');
        setTimeout(()=>{
          tasks = tasks.filter(x=>x.id !== id);
          save();
          render();
        }, 260);
      }

      addBtn.addEventListener('click', ()=> addTask(input.value));
      input.addEventListener('keydown', (e)=>{ if(e.key === 'Enter'){ addTask(input.value); } });

      clearAll.addEventListener('click', ()=>{
        if(!tasks.length) return;
        if(!confirm('すべての予定を本当に削除しますか？')) return;
        tasks = [];
        save();
        render();
      });

      // 初期描画
      render();

      // 少しのアクセシビリティ: フォーカスが入ったら Enter で追加できることを示す
      input.addEventListener('focus', ()=> input.setAttribute('placeholder','Enterで追加できます — 予定を入力'));
      input.addEventListener('blur', ()=> input.setAttribute('placeholder','予定を入力してください（例：会議 14:00）'));

      // テストデータ（初回のみ）
      if(tasks.length === 0){
        const seed = [
          {text:'朝のミーティング', id:'seed1', createdAt: new Date().toLocaleString()},
        ];
        // ただしローカルストレージが空ならシードを入れない（コメントアウトしてます）
        // tasks = seed.concat(tasks);
        // save();
      }
    })();
  </script>
</body>
</html>
